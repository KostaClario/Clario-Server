<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLARIO - 카드 추천</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" th:href="@{/css/bar.css}"/>
    <link rel="stylesheet" th:href="@{/account-css/modal.css}" />

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            /*font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;*/
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            color: #333;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }
        
        .main-content {
            margin-left: 100px;
            padding: 90px 24px 24px 24px;
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .top-section {
            display: grid;
            grid-template-columns: 1fr 480px; /* 차트 영역 줄이고 소비패턴 영역 확대 */
            gap: 24px;
        }

        .chart-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 24px;
            padding: 28px; /* 패딩 약간 줄임 */
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .notification-section {
            background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);
            border-radius: 24px;
            padding: 32px; /* 패딩 증가 */
            position: relative;
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(99, 102, 241, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            min-height: 500px; /* 최소 높이 설정 */
        }

        .notification-title {
            font-size: 18px; /* 폰트 크기 증가 */
            font-weight: 700;
            color: #4338ca;
            margin-bottom: 20px; /* 마진 증가 */
            display: flex;
            align-items: center;
            gap: 8px;
            text-align: center;
        }

        .notification-content {
            font-size: 15px; /* 폰트 크기 증가 */
            color: #4338ca;
            line-height: 1.6;
        }

        .consumption-analysis {
            background: rgba(255, 255, 255, 0.4);
            border-radius: 18px; /* 둥근 모서리 증가 */
            padding: 24px; /* 패딩 증가 */
            margin-bottom: 24px; /* 마진 증가 */
            border: 1px solid rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(10px);
        }

        .analysis-header {
            text-align: center;
            font-weight: 700;
            font-size: 16px; /* 폰트 크기 증가 */
            color: #4338ca;
            margin-bottom: 16px; /* 마진 증가 */
            padding-bottom: 12px; /* 패딩 증가 */
            border-bottom: 1px dashed rgba(67, 56, 202, 0.3);
        }

        .analysis-date {
            text-align: center;
            font-weight: 600;
            font-size: 15px; /* 폰트 크기 증가 */
            color: #4338ca;
            margin-bottom: 20px; /* 마진 증가 */
        }

        .category-list {
            margin-bottom: 20px; /* 마진 증가 */
        }

        .category-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px; /* 마진 증가 */
            font-size: 14px; /* 폰트 크기 증가 */
            color: #4338ca;
            padding: 8px 0; /* 패딩 추가 */
        }

        .category-name {
            display: flex;
            align-items: center;
            gap: 8px; /* 간격 증가 */
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px; /* 간격 증가 */
            margin-top: 20px; /* 마진 증가 */
            padding-top: 16px; /* 패딩 증가 */
            border-top: 1px dashed rgba(67, 56, 202, 0.3);
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.5);
            border-radius: 14px; /* 둥근 모서리 증가 */
            padding: 14px 16px; /* 패딩 증가 */
            font-size: 13px; /* 폰트 크기 증가 */
            color: #4338ca;
            backdrop-filter: blur(10px);
        }

        .stat-label {
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px; /* 간격 증가 */
            margin-bottom: 6px; /* 마진 증가 */
        }

        .stat-value {
            font-weight: 700;
            font-size: 14px; /* 폰트 크기 증가 */
        }

        .tip-box {
            background: rgba(255, 255, 255, 0.5);
            border-radius: 14px; /* 둥근 모서리 증가 */
            padding: 16px; /* 패딩 증가 */
            margin-top: 16px; /* 마진 증가 */
            font-size: 13px; /* 폰트 크기 증가 */
            color: #4338ca;
            display: flex;
            align-items: flex-start;
            gap: 10px; /* 간격 증가 */
            backdrop-filter: blur(10px);
        }

        .tip-icon {
            font-size: 18px; /* 아이콘 크기 증가 */
            flex-shrink: 0;
        }

        .tip-text {
            line-height: 1.6; /* 줄 간격 증가 */
        }

        .recommendation-btn {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            border: none;
            padding: 16px 24px; /* 패딩 증가 */
            border-radius: 28px; /* 둥근 모서리 증가 */
            font-size: 15px; /* 폰트 크기 증가 */
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
            width: 100%;
            margin-top: 24px; /* 마진 증가 */
        }

        .recommendation-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.5);
        }

        .bottom-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 24px;
            padding: 32px;
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 24px;
            color: #1e293b;
            text-align: center;
        }

        .chart-container {
            position: relative;
            width: 100%;
            height: 350px; /* 차트 높이 줄임 */
            margin: 0 auto;
        }

        .chart-layout {
            display: flex;
            align-items: flex-start;
            gap: 24px; /* 간격 줄임 */
            height: 300px; /* 높이 줄임 */
        }

        .chart-canvas-container {
            flex: 0 0 280px; /* 크기 줄임 */
            height: 280px; /* 높이 줄임 */
            position: relative;
        }

        .chart-tabs {
            display: flex;
            gap: 10px; /* 간격 줄임 */
            margin-bottom: 20px; /* 마진 줄임 */
            justify-content: center;
        }

        .chart-tab {
            padding: 10px 16px; /* 패딩 줄임 */
            border: 2px solid rgba(226, 232, 240, 0.8);
            border-radius: 20px; /* 둥근 모서리 줄임 */
            background: rgba(255, 255, 255, 0.8);
            font-size: 12px; /* 폰트 크기 줄임 */
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .chart-tab.active {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            border-color: #6366f1;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }

        .chart-tab:hover:not(.active) {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.1);
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.15);
        }

        .legend {
            display: flex;
            flex-direction: column;
            gap: 8px; /* 간격 줄임 */
            flex: 1;
            height: 280px; /* 높이 줄임 */
            overflow: visible;
            padding-right: 0;
        }

        .legend-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 13px; /* 폰트 크기 줄임 */
            padding: 10px 14px; /* 패딩 줄임 */
            border-radius: 10px; /* 둥근 모서리 줄임 */
            transition: all 0.3s ease;
            background: rgba(248, 250, 252, 0.8);
            border: 1px solid rgba(226, 232, 240, 0.5);
            backdrop-filter: blur(10px);
        }

        .legend-item:hover {
            background: rgba(99, 102, 241, 0.1);
            transform: translateX(4px);
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.15);
        }

        .legend-left {
            display: flex;
            align-items: center;
            gap: 10px; /* 간격 줄임 */
        }

        .legend-color {
            width: 12px; /* 크기 줄임 */
            height: 12px; /* 크기 줄임 */
            border-radius: 50%;
            flex-shrink: 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .legend-percentage {
            font-weight: 700;
            color: #1e293b;
        }

        .legend-value {
            font-size: 11px; /* 폰트 크기 줄임 */
            color: #64748b;
            margin-top: 2px;
        }

        .chart-legend {
            display: flex;
            justify-content: center;
            gap: 20px; /* 간격 줄임 */
            margin-top: 16px; /* 마진 줄임 */
            padding: 12px; /* 패딩 줄임 */
            background: rgba(248, 250, 252, 0.8);
            border-radius: 14px; /* 둥근 모서리 줄임 */
            backdrop-filter: blur(10px);
        }

        .legend-dual {
            display: flex;
            align-items: center;
            gap: 8px; /* 간격 줄임 */
            font-size: 13px; /* 폰트 크기 줄임 */
            font-weight: 600;
        }

        .legend-dual-color {
            width: 16px; /* 크기 줄임 */
            height: 16px; /* 크기 줄임 */
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .card-view-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 24px;
            color: #1e293b;
        }

        .filters {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            flex-wrap: wrap;
            align-items: center;
        }

        .select {
            padding: 12px 16px;
            border: 2px solid rgba(226, 232, 240, 0.8);
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            backdrop-filter: blur(10px);
        }

        .select:hover {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.05);
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.15);
        }

        .select:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .filter-tag {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 13px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
            transition: all 0.3s ease;
        }

        .filter-tag:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }

        .filter-tag .close {
            cursor: pointer;
            font-weight: bold;
            padding: 4px 6px;
            border-radius: 50%;
            transition: background-color 0.2s ease;
        }

        .filter-tag .close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .card-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .card-item {
            display: flex;
            align-items: center;
            gap: 24px;
            padding: 24px;
            border: 2px solid rgba(226, 232, 240, 0.5);
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);

            /* 높이 확장 */
            min-height: 150px; /* 필요에 따라 160~180px까지 조정 가능 */
        }


        .card-item:hover {
            border-color: #6366f1;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 12px 40px rgba(99, 102, 241, 0.15);
            transform: translateY(-4px);
        }

        .card-logo {
            width: 189px;  /* 84 → 126 → 189 */
            height: 122px; /* 54 → 81 → 122 */
            /*border: 2px solid rgba(226, 232, 240, 0.5);*/
            /*border-radius: 24px;*/ /* 필요 시 적용 */
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.8);
            flex-shrink: 0;
            backdrop-filter: blur(10px);
        }


        .card-logo img {
            max-width: 120px;   /* 기존 96px → 더 크게 */
            max-height: 64px;   /* 기존 51px → 더 크게 */
            object-fit: contain;
        }


        .card-info {
            flex: 1;
        }

        .card-name {
            font-size: 17px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 6px;
        }

        .card-bank {
            font-size: 13px;
            color: #6366f1;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .card-description {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .card-benefit {
            font-size: 14px;
            color: #64748b;
            line-height: 1.5;
        }

        .card-type-badge {
            display: inline-block;
            padding: 5px 13px;           /* 기존 4px 10px → 약 1.3배 */
            border-radius: 16px;         /* 기존 12px → 16px */
            font-size: 15.6px;           /* 기존 12px → 15.6px (소수점 반올림 가능) */
            font-weight: 500;
            color: white;
            white-space: nowrap;
            text-align: center;
        }



        .card-type-badge.credit {
            background-color: #2563eb; /* 파란색 */
        }

        .card-type-badge.check {
            background-color: #10b981; /* 초록색 */
        }

        .card-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .details-btn {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 30px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }

        .details-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }

        .loading {
            text-align: center;
            color: #64748b;
            padding: 24px;
            font-weight: 500;
        }

        .error-message {
            text-align: center;
            color: #dc2626;
            padding: 24px;
            font-weight: 500;
        }

        .recommended-cards-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 24px;
            padding: 32px;
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 24px;
            display: none;
        }

        .category-section {
            margin-bottom: 40px;
        }

        .category-title {
            font-size: 20px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
        }

        .card-box {
            background: rgba(255, 255, 255, 0.8);
            border: 2px solid rgba(226, 232, 240, 0.5);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .card-box:hover {
            border-color: #6366f1;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.15);
            transform: translateY(-4px);
        }

        .card-box img {
            width: 100%;
            height: 120px;
            object-fit: contain;
            border-radius: 12px;
            margin-bottom: 16px;
            background: rgba(248, 250, 252, 0.8);
        }

        .card-title {
            font-size: 17px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 8px;
        }

        .card-company {
            font-size: 13px;
            color: #6366f1;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .card-benefit {
            font-size: 14px;
            color: #64748b;
            line-height: 1.5;
            margin-bottom: 16px;
        }

        .card-link {
            display: inline-block;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }

        .card-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }

        .filter-tags {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .reset-btn {
            background: linear-gradient(135deg, #ef4444 0%, #f87171 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 30px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
        }

        .reset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.4);
        }

        @media (max-width: 1200px) {
            .top-section {
                grid-template-columns: 1fr;
            }

            .card-row {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 60px;
            }

            .main-content {
                margin-left: 60px;
                padding: 90px 16px 16px 16px;
            }

            .header {
                padding: 0 16px;
            }

            .nav-icon {
                width: 44px;
                height: 44px;
                font-size: 18px;
            }

            .card-item {
                flex-direction: column;
                text-align: center;
            }

            .chart-layout {
                flex-direction: column;
                height: auto;
            }

            .chart-canvas-container {
                width: 100%;
                flex: none;
            }

            .legend {
                width: 100%;
                height: auto;
                padding-right: 0;
            }

            .card-row {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .header-right .user-name {
                display: none;
            }

            .chart-container {
                height: auto;
            }

            .filters {
                flex-direction: column;
            }
        }
    </style>
</head>
<aside th:fragment="sidebar" class="sidebar">
    <div class="logo">
        <img src="/img/ClarioLogoTextOnly.png" alt="CLARIO Logo">
    </div>
    <ul class="menu">
        <li><a class="nav-icon" href="/dashboard">🏠</a></li>
        <li><a class="nav-icon" href="/statistics">📈</a></li>
        <li><a class="nav-icon" href="/history">☰</a></li>
        <li><a class="nav-icon active" href="/card">💳</a></li>
    </ul>
</aside>
<div th:replace="~{headerside :: allModals}"></div>
<div th:replace="~{headerside :: header}"></div>
<body>
<div class="container">
    <main class="main-content">
        <div class="top-section">
            <section class="chart-section">
                <h2 class="section-title">소비 카테고리 분석</h2>

                <div class="chart-tabs">
                    <div class="chart-tab active" id="dualTab" onclick="switchChart('dual')">📊 통합 분석</div>
                    <div class="chart-tab" id="amountTab" onclick="switchChart('amount')">💰 금액별</div>
                    <div class="chart-tab" id="countTab" onclick="switchChart('count')">🔢 횟수별</div>
                </div>

                <div id="chartContainer" class="chart-container">
                    <canvas id="dualChart"></canvas>
                    <div id="doughnutLayout" class="chart-layout" style="display: none;">
                        <div class="chart-canvas-container">
                            <canvas id="doughnutChart"></canvas>
                        </div>
                        <div id="categoryLegend" class="legend">
                            <div class="loading">데이터 로딩중...</div>
                        </div>
                    </div>
                </div>

                <div class="chart-legend" id="chartLegend" style="display: none;">
                    <div class="legend-dual">
                        <div class="legend-dual-color" style="background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);"></div>
                        <span>💰 금액 (원)</span>
                    </div>
                    <div class="legend-dual">
                        <div class="legend-dual-color" style="background: linear-gradient(135deg, #f472b6 0%, #ec4899 100%);"></div>
                        <span>🔢 횟수 (회)</span>
                    </div>
                </div>
            </section>

            <section class="notification-section">
                <div id="notificationContent">
                    <div class="consumption-analysis">
                        <div class="analysis-header">소비 패턴 분석</div>
                        <div class="analysis-date">🗓️ 2025년 6월 소비 패턴 분석</div>
                        <div style="font-size: 14px; margin-bottom: 16px; font-weight: 600;">상위 카테고리:</div>
                        <div class="category-list">
                            <div class="category-item">
                                <div class="category-name">🎮 여가비</div>
                                <div>327,000원 (4회)</div>
                            </div>
                            <div class="category-item">
                                <div class="category-name">💡 고정비</div>
                                <div>298,000원 (3회)</div>
                            </div>
                            <div class="category-item">
                                <div class="category-name">🍷 유흥비</div>
                                <div>267,049원 (5회)</div>
                            </div>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <div class="stat-label">💵 총 지출</div>
                                <div class="stat-value">892,049원 / 12회</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">📉 전월 대비</div>
                                <div class="stat-value">▲15.2% 증가</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">📊 소비 비중</div>
                                <div class="stat-value">78% (총 수입 대비)</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">📆 평균 결제 간격</div>
                                <div class="stat-value">2.6일</div>
                            </div>
                        </div>
                        <div class="tip-box">
                            <div class="tip-icon">💡</div>
                            <div class="tip-text">Tip: 고정비가 높습니다. 통신비 비교를 고려해보세요.</div>
                        </div>
                    </div>
                </div>
                <button class="recommendation-btn" id="recommendCardBtn">맞춤 카드 추천받기</button>
            </section>
        </div>

        <section class="recommended-cards-section" id="recommendedCardsSection">
            <h2 class="card-view-title">🎯 맞춤 추천 카드</h2>
            <div id="recommendedCardList"></div>
        </section>

        <section class="bottom-section">
            <h2 class="card-view-title">카드 보기</h2>

            <div class="filters">
                <select class="select" id="cardTypeFilter">
                    <option value="">카드 유형</option>
                    <option value="신용">신용카드</option>
                    <option value="체크">체크카드</option>
                </select>
                <select class="select" id="benefitFilter">
                    <option value="">혜택 선택</option>
                    <option value="식비">식비</option>
                    <option value="교통비">교통비</option>
                    <option value="여가비">여가비</option>
                    <option value="고정비">고정비</option>
                    <option value="유흥비">유흥비</option>
                    <option value="건강비">건강비</option>
                    <option value="생활비">생활비</option>
                    <option value="기타">기타</option>
                </select>
                <div class="filter-tags" id="filterTags"></div>
                <button class="reset-btn" id="resetFiltersBtn">🔄 필터 초기화</button>
            </div>

            <div class="card-list" id="cardList">
                <div class="loading">카드 정보를 불러오는 중...</div>
            </div>
        </section>
    </main>
</div>

<script>
    const config = {
        timeout: 5000,
        colors: [
            'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)',
            'linear-gradient(135deg, #f472b6 0%, #ec4899 100%)',
            'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',
            'linear-gradient(135deg, #10b981 0%, #059669 100%)',
            'linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)',
            'linear-gradient(135deg, #f97316 0%, #ea580c 100%)'
        ],
        solidColors: ['#3b82f6', '#f472b6', '#f59e0b', '#10b981', '#8b5cf6', '#f97316']
    };

    let dualChart = null;
    let doughnutChart = null;
    let currentFilters = {
        cardType: '',
        categories: []
    };

    let chartData = {
        amountBased: [],
        countBased: []
    };
    let currentChartType = 'dual';

    // 로딩 상태 관리
    let isLoadingChart = false;
    let isLoadingCards = false;

    // 카테고리별 이모지 매핑
    const emojiMap = {
        '식비': '🍽',
        '교통비': '🚗',
        '고정비': '💡',
        '유흥비': '🍷',
        '여가비': '🎮',
        '건강비': '🏥',
        '기타': '📦',
        '생활비': '📱'
    };

    // 유틸리티 함수
    const utils = {
        updateCurrentDate: () => {
            const dateString = new Date().toLocaleDateString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                weekday: 'short'
            });
            document.getElementById('currentDate').textContent = dateString;
        }
    };

    // 카드 렌더링 함수 (백엔드에서 그룹화된 데이터 받음)
    function renderGroupedCards(groupedCards) {
        console.log('🎨 카드 렌더링:', groupedCards);

        const container = document.getElementById('recommendedCardList');
        container.innerHTML = '';

        let hasCards = false;

        for (const [category, cards] of Object.entries(groupedCards)) {
            if (cards && cards.length > 0) {
                hasCards = true;
                const emoji = emojiMap[category] || '📊';
                const groupHTML = `
                        <div class="category-section">
                            <h3 class="category-title">${emoji} ${category} 관련 추천카드</h3>
                            <div class="card-row">
                                ${cards.map(card => {
                    const cardTypeClass = {
                        '신용': 'credit',
                        '체크': 'check'
                    }[card.cardType] || 'default';
                    return `
        <div class="card-box">
            <img src="/img/card/${card.cardRecommendationId}.png"
                alt="${card.cardName || '카드'}"
                onerror="this.onerror=null; this.src='data:image/svg+xml;base64,...'" />
            <div class="card-type-badge ${cardTypeClass}">${card.cardType}</div>
            <div class="card-title">${card.cardName || '카드명 없음'}</div>
            <div class="card-company">${card.cardCompany || card.bankName || '발급사 정보 없음'}</div>
            <div class="card-benefit">${card.benefitSummary || card.benefit || '혜택 정보 없음'}</div>
            <a href="${card.cardUrl || '#'}" target="_blank" class="card-link">카드 신청하기</a>
        </div>
    `;
                }).join('')}

                            </div>
                        </div>
                    `;
                container.insertAdjacentHTML('beforeend', groupHTML);
            }
        }

        if (!hasCards) {
            container.innerHTML = '<div class="error-message">추천할 수 있는 카드가 없습니다.</div>';
        }

        document.getElementById('recommendedCardsSection').style.display = 'block';
    }

    // 소비 카테고리 차트 생성
    const createCategoryChart = async () => {
        if (isLoadingChart) return;
        isLoadingChart = true;

        try {
            const legendContainer = document.getElementById('categoryLegend');
            legendContainer.innerHTML = '<div class="loading">데이터 로딩중...</div>';

            const now = new Date();
            const response = await axios.get('/api/statistics/top-category-stats', {
                params: {
                    year: now.getFullYear(),
                    month: now.getMonth() + 1
                },
                timeout: config.timeout
            });

            const data = response.data;
            chartData.amountBased = data.amountBased || [];
            chartData.countBased = data.countBased || [];

            if (chartData.amountBased.length === 0 && chartData.countBased.length === 0) {
                legendContainer.innerHTML = '<div class="error-message">소비 데이터가 없습니다</div>';
                updateNotificationContent(null);
                return;
            }

            renderChart(currentChartType);
            updateNotificationContent(data);

        } catch (error) {
            console.error('차트 생성 실패:', error.message);
            document.getElementById('categoryLegend').innerHTML = '<div class="error-message">차트 데이터를 불러올 수 없습니다</div>';
            updateNotificationContent(null);
        } finally {
            isLoadingChart = false;
        }
    };

    // 알림 내용 업데이트 함수
    const updateNotificationContent = (data) => {
        const notificationContainer = document.getElementById('notificationContent');

        if (!data || !data.totalAmount) {
            notificationContainer.innerHTML = `
                    <div class="consumption-analysis">
                        <div class="analysis-header">소비 패턴 분석</div>
                        <div style="text-align: center; color: #4338ca; padding: 20px;">
                            소비 데이터가 부족합니다.
                        </div>
                    </div>
                `;
            return;
        }

        const now = new Date();
        const currentYear = now.getFullYear();
        const currentMonth = now.getMonth() + 1;

        // 전월 대비 증감률 계산
        let growthRate = 0;
        let growthText = '0%';
        let growthIcon = '➖';

        if (data.previousMonthAmount && data.previousMonthAmount > 0) {
            growthRate = ((data.totalAmount - data.previousMonthAmount) / data.previousMonthAmount * 100);
            growthText = (growthRate > 0 ? '▲' : '▼') + Math.abs(growthRate).toFixed(1) + '%';
            growthIcon = growthRate > 0 ? '▲' : '▼';
            growthText += growthRate > 0 ? ' 증가' : ' 감소';
        }

        // 소비 비중 계산
        let spendingRatio = 0;
        let spendingRatioText = '계산 불가';

        if (data.userIncome && data.userIncome > 0) {
            spendingRatio = (data.totalAmount / data.userIncome * 100);
            spendingRatioText = spendingRatio.toFixed(0) + '% (총 수입 대비)';
        }

        // 평균 결제 간격 계산
        let avgInterval = '계산 불가';
        if (data.totalCount && data.totalCount > 0) {
            const daysInMonth = new Date(currentYear, currentMonth, 0).getDate();
            const interval = (daysInMonth / data.totalCount).toFixed(1);
            avgInterval = interval + '일';
        }

        // 상위 카테고리 3개 추출
        const top3Categories = data.amountBased ? data.amountBased.slice(0, 3) : [];

        let categoryBreakdown = '';
        if (top3Categories.length > 0) {
            categoryBreakdown = top3Categories.map(item => {
                const emoji = emojiMap[item.categoryName] || '📊';
                const countItem = data.countBased ? data.countBased.find(count => count.categoryName === item.categoryName) : null;
                const usageCount = countItem ? countItem.usageCount : 0;
                return `
                        <div class="category-item">
                            <div class="category-name">${emoji} ${item.categoryName}</div>
                            <div>${(item.totalAmount || 0).toLocaleString()}원 (${usageCount}회)</div>
                        </div>
                    `;
            }).join('');
        }

        // 팁 생성
        let tipText = '소비 패턴을 분석하여 맞춤형 카드를 추천해드립니다.';
        if (top3Categories.length > 0) {
            const topCategory = top3Categories[0].categoryName;
            switch(topCategory) {
                case '고정비':
                    tipText = 'Tip: 고정비가 높습니다. 통신비나 공과금 할인 혜택을 고려해보세요.';
                    break;
                case '식비':
                    tipText = 'Tip: 식비 지출이 많습니다. 음식점이나 배달 할인 혜택 카드를 추천합니다.';
                    break;
                case '교통비':
                    tipText = 'Tip: 교통비 지출이 많습니다. 대중교통이나 주유 할인 카드를 고려해보세요.';
                    break;
                case '여가비':
                    tipText = 'Tip: 여가 활동이 활발하시네요. 문화생활이나 쇼핑 할인 혜택을 확인해보세요.';
                    break;
                case '유흥비':
                    tipText = 'Tip: 유흥비 지출이 많습니다. 카페나 술집 할인 혜택 카드를 추천합니다.';
                    break;
                case '생활비':
                    tipText = 'Tip: 생활비 지출이 많습니다. 마트나 생필품 할인 혜택 카드를 활용해보세요.';
                    break;
                case '건강비':
                    tipText = 'Tip: 건강 관련 지출이 많습니다. 병원비, 약국 또는 헬스장 할인 혜택 카드를 확인해보세요.';
                    break;
                default:
                    tipText = `Tip: ${topCategory} 지출이 많습니다. 관련 할인 혜택을 확인해보세요.`;
            }
        }

        notificationContainer.innerHTML = `
                <div class="consumption-analysis">
                    <div class="analysis-header">소비 패턴 분석</div>
                    <div class="analysis-date">🗓️ ${currentYear}년 ${currentMonth}월 소비 패턴 분석</div>
                    ${top3Categories.length > 0 ? `
                        <div style="font-size: 14px; margin-bottom: 16px; font-weight: 600;">상위 카테고리:</div>
                        <div class="category-list">
                            ${categoryBreakdown}
                        </div>
                    ` : ''}
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-label">💵 총 지출</div>
                            <div class="stat-value">${data.totalAmount.toLocaleString()}원 / ${data.totalCount}회</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">📉 전월 대비</div>
                            <div class="stat-value">${growthText}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">📊 소비 비중</div>
                            <div class="stat-value">${spendingRatioText}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">📆 평균 결제 간격</div>
                            <div class="stat-value">${avgInterval}</div>
                        </div>
                    </div>
                    <div class="tip-box">
                        <div class="tip-icon">💡</div>
                        <div class="tip-text">${tipText}</div>
                    </div>
                </div>
            `;
    };

    // 차트 렌더링
    const renderChart = (type) => {
        const dualChartElement = document.getElementById('dualChart');
        const doughnutLayoutElement = document.getElementById('doughnutLayout');
        const chartLegendElement = document.getElementById('chartLegend');

        if (type === 'dual') {
            dualChartElement.style.display = 'block';
            doughnutLayoutElement.style.display = 'none';
            chartLegendElement.style.display = 'flex';
            renderDualChart();
        } else {
            dualChartElement.style.display = 'none';
            doughnutLayoutElement.style.display = 'flex';
            chartLegendElement.style.display = 'none';
            renderDoughnutChart(type);
        }
    };

    // 이중 축 차트 렌더링 (더 세련되게)
    const renderDualChart = () => {
        const amountData = chartData.amountBased;
        const countData = chartData.countBased;

        if (!amountData || !countData || amountData.length === 0 || countData.length === 0) {
            document.getElementById('dualChart').style.display = 'none';
            document.getElementById('chartLegend').style.display = 'none';
            document.getElementById('doughnutLayout').innerHTML = '<div class="error-message">통합 차트 데이터가 없습니다</div>';
            document.getElementById('doughnutLayout').style.display = 'block';
            return;
        }

        const categories = amountData.map(item => item.categoryName);
        const amounts = amountData.map(item => item.totalAmount || 0);
        const counts = categories.map(category => {
            const countItem = countData.find(item => item.categoryName === category);
            return countItem ? (countItem.usageCount || 0) : 0;
        });

        if (dualChart) dualChart.destroy();

        const ctx = document.getElementById('dualChart').getContext('2d');

        // 그라데이션 생성
        const amountGradient = ctx.createLinearGradient(0, 0, 0, 400);
        amountGradient.addColorStop(0, 'rgba(59, 130, 246, 0.9)');
        amountGradient.addColorStop(1, 'rgba(29, 78, 216, 0.7)');

        const countGradient = ctx.createLinearGradient(0, 0, 0, 400);
        countGradient.addColorStop(0, 'rgba(244, 114, 182, 0.9)');
        countGradient.addColorStop(1, 'rgba(236, 72, 153, 0.7)');

        dualChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: categories,
                datasets: [
                    {
                        label: '금액 (원)',
                        data: amounts,
                        backgroundColor: amountGradient,
                        borderColor: '#3b82f6',
                        borderWidth: 0,
                        yAxisID: 'y',
                        borderRadius: 8,
                        borderSkipped: false,
                        barThickness: 'flex',
                        maxBarThickness: 50, // 막대 두께 줄임
                    },
                    {
                        label: '횟수 (회)',
                        data: counts,
                        backgroundColor: countGradient,
                        borderColor: '#f472b6',
                        borderWidth: 0,
                        yAxisID: 'y1',
                        borderRadius: 8,
                        borderSkipped: false,
                        barThickness: 'flex',
                        maxBarThickness: 50, // 막대 두께 줄임
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: { mode: 'index', intersect: false },
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: 'rgba(255, 255, 255, 0.1)',
                        borderWidth: 1,
                        cornerRadius: 12,
                        displayColors: true,
                        callbacks: {
                            label: function(context) {
                                const label = context.dataset.label;
                                const value = context.parsed.y;
                                return label.includes('금액') ?
                                    `${label}: ${value.toLocaleString()}원` :
                                    `${label}: ${value}회`;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        grid: { display: false },
                        ticks: {
                            font: { size: 12, weight: 600 }, // 폰트 크기 줄임
                            color: '#64748b'
                        }
                    },
                    y: {
                        type: 'linear',
                        display: true,
                        position: 'left',
                        title: {
                            display: true,
                            text: '금액 (원)',
                            font: { size: 12, weight: 700 }, // 폰트 크기 줄임
                            color: '#3b82f6'
                        },
                        ticks: {
                            callback: value => value.toLocaleString() + '원',
                            color: '#3b82f6',
                            font: { weight: 600, size: 11 } // 폰트 크기 줄임
                        },
                        grid: {
                            color: 'rgba(59, 130, 246, 0.1)',
                            drawBorder: false
                        }
                    },
                    y1: {
                        type: 'linear',
                        display: true,
                        position: 'right',
                        title: {
                            display: true,
                            text: '횟수 (회)',
                            font: { size: 12, weight: 700 }, // 폰트 크기 줄임
                            color: '#f472b6'
                        },
                        ticks: {
                            callback: value => value + '회',
                            color: '#f472b6',
                            font: { weight: 600, size: 11 } // 폰트 크기 줄임
                        },
                        grid: { drawOnChartArea: false }
                    }
                },
                animation: {
                    duration: 1500,
                    easing: 'easeInOutCubic'
                }
            }
        });
    };

    // 도넛 차트 렌더링 (더 세련되게)
    const renderDoughnutChart = (type) => {
        const data = type === 'amount' ? chartData.amountBased : chartData.countBased;

        if (!data || data.length === 0) {
            document.getElementById('categoryLegend').innerHTML =
                `<div class="error-message">${type === 'amount' ? '금액' : '횟수'} 기준 데이터가 없습니다</div>`;
            return;
        }

        const labels = data.map(item => item.categoryName);
        const values = data.map(item => type === 'amount' ? (item.totalAmount || 0) : (item.usageCount || 0));
        const total = values.reduce((sum, val) => sum + val, 0);

        if (total === 0) {
            document.getElementById('categoryLegend').innerHTML = '<div class="error-message">데이터 값이 모두 0입니다</div>';
            return;
        }

        const percentages = values.map(val => Math.round((val / total) * 100));
        const colors = config.solidColors.slice(0, labels.length);

        if (doughnutChart) doughnutChart.destroy();

        const ctx = document.getElementById('doughnutChart').getContext('2d');
        doughnutChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: labels,
                datasets: [{
                    data: values,
                    backgroundColor: colors,
                    borderWidth: 4,
                    borderColor: '#ffffff',
                    cutout: '65%',
                    hoverBorderWidth: 6,
                    hoverOffset: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: 'rgba(255, 255, 255, 0.1)',
                        borderWidth: 1,
                        cornerRadius: 12,
                        callbacks: {
                            label: (context) => {
                                const percentage = percentages[context.dataIndex];
                                const value = values[context.dataIndex];
                                const unit = type === 'amount' ? '원' : '회';
                                return `${labels[context.dataIndex]}: ${percentage}% (${value.toLocaleString()}${unit})`;
                            }
                        }
                    }
                },
                animation: {
                    duration: 1500,
                    easing: 'easeInOutCubic'
                }
            }
        });

        const legendContainer = document.getElementById('categoryLegend');
        legendContainer.innerHTML = '';

        labels.forEach((label, index) => {
            const legendItem = document.createElement('div');
            legendItem.className = 'legend-item';
            const unit = type === 'amount' ? '원' : '회';
            legendItem.innerHTML = `
                    <div class="legend-left">
                        <div class="legend-color" style="background: ${colors[index]};"></div>
                        <div>
                            <div>${label}</div>
                            <div class="legend-value">${values[index].toLocaleString()}${unit}</div>
                        </div>
                    </div>
                    <span class="legend-percentage">${percentages[index]}%</span>
                `;
            legendContainer.appendChild(legendItem);
        });
    };

    // 차트 타입 전환
    const switchChart = (type) => {
        currentChartType = type;
        document.getElementById('dualTab').classList.toggle('active', type === 'dual');
        document.getElementById('amountTab').classList.toggle('active', type === 'amount');
        document.getElementById('countTab').classList.toggle('active', type === 'count');
        renderChart(type);
    };

    //카드 목록 로드
    const loadCards = async () => {
        if (isLoadingCards) return;
        isLoadingCards = true;

        try {
            let response;

            if (currentFilters.categories.length > 0 || currentFilters.cardType) {
                const requestData = { cardType: currentFilters.cardType || null };
                if (currentFilters.categories.length > 0) {
                    requestData.parentCategories = currentFilters.categories;
                }
                response = await axios.post('/api/card/filter', requestData, {
                    timeout: config.timeout,
                    headers: { 'Content-Type': 'application/json' }
                });
            } else {
                response = await axios.get('/api/card/all', { timeout: config.timeout });
            }

            const cards = response.data;
            const cardListContainer = document.getElementById('cardList');
            cardListContainer.innerHTML = '';

            const typeClassMap = {
                '신용': 'credit',
                '체크': 'check'
            };

            if (!cards || cards.length === 0) {
                cardListContainer.innerHTML = '<div class="error-message">카드 정보가 없습니다</div>';
                return;
            }

            cards.forEach(card => {
                const cardTypeClass = typeClassMap[card.cardType] || 'default';

                const cardItem = document.createElement('div');
                cardItem.className = 'card-item';
                cardItem.innerHTML = `
                <div class="card-logo">
                    <img src="/img/card/${card.cardRecommendationId}.png"
                         alt="${card.cardName || '카드'}"
                         onerror="this.onerror=null; this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjEyMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjhmOWZhIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OTk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkNBUkQ8L3RleHQ+PC9zdmc='">
                </div>
                <div class="card-info">
                    <div class="card-name">${card.cardName || '카드명 정보 없음'}</div>
                    ${card.bankName ? `<div class="card-bank">${card.bankName}</div>` : ''}
                    ${card.cardType ? `<div class="card-type-badge ${cardTypeClass}">${card.cardType}</div>` : ''}
                    ${card.description ? `<div class="card-description">${card.description}</div>` : ''}
                    ${card.benefitSummary ? `<div class="card-benefit">💳 ${card.benefitSummary}</div>` : ''}
                </div>
                <div class="card-actions">
                    ${card.cardUrl ?
                    `<button class="details-btn" onclick="window.open('${card.cardUrl}', '_blank')">카드 신청하기</button>` :
                    `<button class="details-btn" disabled style="opacity: 0.5; cursor: not-allowed;">정보 없음</button>`
                }
                </div>
            `;
                cardListContainer.appendChild(cardItem);
            });

        } catch (error) {
            console.error('카드 조회 실패:', error);
            document.getElementById('cardList').innerHTML = '<div class="error-message">카드 정보를 불러올 수 없습니다</div>';
        } finally {
            isLoadingCards = false;
        }
    };


    // 필터 관련 함수들
    const resetFilters = () => {
        currentFilters.cardType = '';
        currentFilters.categories = [];
        document.getElementById('cardTypeFilter').value = '';
        document.getElementById('benefitFilter').value = '';
        updateFilterTags();
        loadCards();
    };

    const updateFilterTags = () => {
        const filterTagsContainer = document.getElementById('filterTags');
        filterTagsContainer.innerHTML = '';
        currentFilters.categories.forEach(category => {
            const tag = document.createElement('div');
            tag.className = 'filter-tag';
            tag.innerHTML = `${category} <span class="close" onclick="removeFilter('${category}')">×</span>`;
            filterTagsContainer.appendChild(tag);
        });
    };

    const removeFilter = (category) => {
        currentFilters.categories = currentFilters.categories.filter(cat => cat !== category);
        updateFilterTags();
        loadCards();
    };

    // 이벤트 리스너 설정
    document.addEventListener('DOMContentLoaded', async () => {
        utils.updateCurrentDate();

        // 초기 데이터 로드
        try {
            await Promise.all([
                createCategoryChart(),
                loadCards()
            ]);
        } catch (error) {
            console.error('초기 데이터 로드 실패:', error);
        }

        // 카드 추천 버튼
        document.getElementById('recommendCardBtn').addEventListener('click', async () => {
            try {
                console.log('🎯 카드 추천 시작');

                let topCategories = [];
                if (chartData.amountBased && chartData.amountBased.length > 0) {
                    topCategories = chartData.amountBased.slice(0, 3).map(item => item.categoryName);
                }

                if (topCategories.length === 0) {
                    alert('추천을 위한 소비 데이터가 부족합니다.');
                    return;
                }

                console.log('📊 상위 카테고리:', topCategories);

                const response = await axios.post('/api/card/recommend/grouped', {
                    parentCategories: topCategories,
                    cardType: null
                }, {
                    headers: { 'Content-Type': 'application/json' },
                    timeout: config.timeout
                });

                const groupedCards = response.data || {};
                console.log('💳 그룹화된 카드 응답:', groupedCards);

                if (Object.keys(groupedCards).length === 0) {
                    alert('추천 가능한 카드가 없습니다.');
                    return;
                }

                renderGroupedCards(groupedCards);

            } catch (error) {
                console.error('❌ 카드 추천 실패:', error);
                alert('카드 추천에 실패했습니다.');
            }
        });

        // 기타 이벤트 리스너들
        document.querySelectorAll('.nav-icon').forEach(icon => {
            icon.addEventListener('click', function() {
                document.querySelectorAll('.nav-icon').forEach(i => i.classList.remove('active'));
                this.classList.add('active');
            });
        });

        document.querySelector('.logout-btn').addEventListener('click', () => {
            if (confirm('로그아웃 하시겠습니까?')) {
                alert('로그아웃 되었습니다.');
            }
        });

        document.getElementById('cardTypeFilter').addEventListener('change', function() {
            currentFilters.cardType = this.value;
            loadCards();
        });

        document.getElementById('benefitFilter').addEventListener('change', function() {
            const selectedCategory = this.value;
            if (selectedCategory && !currentFilters.categories.includes(selectedCategory)) {
                currentFilters.categories.push(selectedCategory);
                updateFilterTags();
                loadCards();
            }
            this.value = '';
        });

        document.getElementById('resetFiltersBtn').addEventListener('click', resetFilters);
    });
</script>
<script th:src="@{/js/modal.js}"></script>
</body>
</html>